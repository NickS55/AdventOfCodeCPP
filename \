// Day 3, part 1
#include <fstream>
#include <iostream>
#include <string>

bool getIsSymbol(char character) {
  int ichar{(int)character};
  if (ichar > 32 && ichar < 48) {
    return true;
  }
  return false;
}

int getCharValue(char character) {
  int ichar{(int)character - '0'};
  if (ichar > 0 && ichar < 10) {
    return ichar;
  }
  return 0;
}

int getMinIndex(int index) { return index < 0 ? 0 : index; }

bool isTouchingSymbol(std::string cur, std::string next, std::string prev,
                      int leftIndex, int RightIndex) {
  while (leftIndex <= RightIndex) {
    if (next.length() && getIsSymbol(next[leftIndex])) {
      return true;
    }
    if (prev.length() && getIsSymbol(prev[leftIndex])) {
      return true;
    }
    if (getIsSymbol(cur[leftIndex])) {
      return true;
    }
    leftIndex += 1;
  }
  return false;
}

int getSumEngineValues(std::string cur, std::string next, std::string prev) {
  int sum{};
  int i{};

  int curSum{};
  while (i <= cur.length()) {
    int curValue{getCharValue(cur[i])};
    int leftIndex{-1};
    int rightIndex{-1};
    if (curValue) {
      curSum *= 10;
      curSum += curValue;
      leftIndex = leftIndex < 0 ? getMinIndex(i - 1) : leftIndex;
      rightIndex = i > cur.length() ? cur.length() : i;
      std::cout << curSum << "\n";
    }
    if ((!curValue || i == cur.length())) {
      if (leftIndex >= 0 &&
          isTouchingSymbol(cur, next, prev, leftIndex, rightIndex)) {
        sum += curSum;
        std::cout << curSum << "\n";
      }
      leftIndex = -1;
      rightIndex = -1;
      curSum = 0;
    }
    i++;
  }
  return sum;
}

int main(int argc, char *argv[]) {
  using std::cout;
  using std::ifstream;
  using std::string;

  ifstream File(argv[1]);

  string prevText{};
  string curText{};
  string nextText{};
  string newText{};

  int sum{};
  getline(File, curText);
  getline(File, nextText);
  sum += getSumEngineValues(curText, nextText, prevText);
  while (getline(File, newText)) {
    prevText = curText;
    curText = nextText;
    nextText = newText;
    sum += getSumEngineValues(curText, nextText, prevText);
  }
  cout << sum;

  File.close();
  return 0;
}
